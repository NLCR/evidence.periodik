<VirtualHost *:8080>
    ServerName app.permonik.nkp.cz
    ServerAlias app.permonik-test.nkp.cz

    ProxyPreserveHost On

    ProxyPass /api http://permonik-api:8080/api
    ProxyPassReverse /api http://permonik-api:8080/api

    ProxyPass / http://permonik-web-admin:8080/
    ProxyPassReverse / http://permonik-web-admin:8080/

    <Location /Shibboleth.sso>
        SetHandler shib
    </Location>

    <Location /login/shibboleth>
        AuthType shibboleth
        Require shibboleth
        ShibRequestSetting requireSession 1
        ShibUseHeaders On
    </Location>

    <Location /api/auth/login/shibboleth>
        AuthType            shibboleth
        Require             shibboleth
        ShibRequestSetting  requireSession  1
        ShibUseHeaders On
    </Location>
</VirtualHost>

<VirtualHost *:8080>
    ServerName permonik.nkp.cz
    ServerAlias permonik-test.nkp.cz

    ProxyPreserveHost On

    ProxyPass /api http://permonik-api:8080/api
    ProxyPassReverse /api http://permonik-api:8080/api

    ProxyPass / http://permonik-web-public:8080/
    ProxyPassReverse / http://permonik-web-public:8080/
</VirtualHost>
